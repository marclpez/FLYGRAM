slp_Filter=function(a){let callbacks,method,topic;topic=a&&slp.topics[a];if(!topic){if(typeof(jQuery.Callbacks)!=="undefined"){callbacks=jQuery.Callbacks();topic={publish:callbacks.fire,subscribe:callbacks.add,unsubscribe:callbacks.remove}}else{slp.log("jQuery 1.7.0+ required, "+jQuery.fn.version+" used instead.");topic={publish:function(b){return b}}}if(a){slp.topics[a]=topic}}return topic};slp={generic_object:{a:document.createElement("a")},important_object:{address_div:{},address_input:{},find_button:{},map:{},results:{},search_form:{},slp_div:{}},topics:{},sensor:{},filter:function(a){slp_Filter(a)},init:function(){if(typeof slplus!=="undefined"){if(window.location.protocol!==slplus.ajaxurl.substring(0,slplus.ajaxurl.indexOf(":")+1)){slplus.ajaxurl=slplus.ajaxurl.replace(slplus.ajaxurl.substring(0,slplus.ajaxurl.indexOf(":")+1),window.location.protocol)}}var d=/radio|checkbox/i,a=/[^\[\]]+/g,c=/^[\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?$/;var b=function(e){if(typeof e==="number"){return true}if(typeof e!=="string"){return false}return e.match(c)};jQuery.fn.extend({formParams:function(e){if(this[0].nodeName.toLowerCase()=="form"&&this[0].elements){return jQuery(jQuery.makeArray(this[0].elements)).getParams(e)}return jQuery("input[name], textarea[name], select[name]",this[0]).getParams(e)},getParams:function(g){var e={},f;g=g===undefined?true:g;this.each(function(){var h=this,m=h.type&&h.type.toLowerCase();if((m=="submit")||!h.name){return}var o=h.name,n=jQuery.data(h,"value")||jQuery.fn.val.call([h]),j=d.test(h.type),k=o.match(a),p=!j||!!h.checked,q;if(g){if(b(n)){n=parseFloat(n)}else{if(n==="true"||n==="false"){n=Boolean(n)}}}f=e;for(var l=0;l<k.length-1;l++){if(!f[k[l]]){f[k[l]]={}}f=f[k[l]]}q=k[k.length-1];if(q in f&&m==="checkbox"){if(!Array.isArray(f[q])){f[q]=f[q]===undefined?[]:[f[q]]}if(p){f[q].push(n)}}else{if(p||!f[q]){f[q]=p?n:undefined}}});return e}})},run:function(){slp.init();slp.start_map()},log:function(a){if(window.console){console.log(a)}},notification:function(){this.inline=function(c,b){var a='<div class="container fluid grid-list-lg" style="min-height: 0px;"><div class="layout row wrap"><div class="flex xs12"><div class="white--text card blue-grey darken-2" data-ripple="false" style="height: auto;"><div class="card__title card__title--primary"><div class="headline">'+c+"</div><div>"+b+"</div></div></div></div></div></div>";return a}},setup_helpers:function(){slp.important_object={address_row:jQuery("#addy_in_address"),address_input:jQuery("#addressInput"),map:jQuery("#map"),results:jQuery("#map_sidebar"),search_form:jQuery("#searchForm"),slp_div:jQuery("div.store_locator_plus")};String.prototype.replace_shortcodes=function(){var a=arguments;var c=a[0];var b=/\[(\w+)\s+([\w\.]+)\s*(\w*)(?:[\s="]*)([\w|\.]*)(?:[\s"]*)\s*(\w*)(?:[\s="]*)([\w|\.]*)(?:[\s"]*)\]/g;return this.replace(b,function(j,i,d,f,l,m,q){var h,e,p;switch(i){case"slp_location":if(d==="latitude"){d="lat"}if(d==="longitude"){d="lng"}p="";h="";if(c[d]){p=c[d];h=d}else{if(d.indexOf(".")>1){var n=/(\w+)/gi;var g=d.match(n);var o=g[0];if(!c[o]){return""}var k=g[1];p=c[o][k];if(!p){return""}h=o+"_"+k}else{return""}}e=p.shortcode_modifier({modifier:f,modarg:l,field_name:h,marker:c});if(m){e=e.shortcode_modifier({modifier:m,modarg:q,field_name:h,marker:c})}return e;case"slp_option":var r=slplus.options;slp_Filter("replace_shortcodes_options").publish(r);if(d==="name"){d=l;l=""}if(!r[d]){jQuery.ajax({url:slplus.rest_url+"options/"+d,dataType:"json",success:function(t){var s;if(typeof t==="string"){s=jQuery.parseJSON(t)}else{s=t}r[d]=s.value;e=slp.shortcode_output(c,h,r[d],f,l,m,q);jQuery('span[data-option="'+d+'"][data-locationid="'+c.id+'"]').html(e).show()},error:function(s,u,t){return""}});return'<span data-option="'+d+'" data-locationid="'+c.id+'"></span>'}else{return slp.shortcode_output(c,h,r[d],f,l,m,q)}case"html":var e="";switch(d){case"br":e="<br/>";break;case"closing_anchor":e="</a>";break;default:break}e=e.shortcode_modifier({modifier:f,modarg:l,field_name:"raw_html",marker:c});if(m){e=e.shortcode_modifier({modifier:m,modarg:q,field_name:"raw_html",marker:c})}return e;case"slp_addon":return"";default:return j+" not supported"}})};String.prototype.shortcode_modifier=function(){var h=arguments;var j=h[0];var a=j.modifier;var g=j.modarg;var d=j.field_name;var b=true;var e=function(m,l){var n=m.split(".");if(n.length===1){if(l[m]){return l[m]}return l.data[m]}else{return l.data[n[1]]}};if(d==="hours"){b=false}var i=this;var f="";var k="";if(a){switch(a){case"ifset":if(!e(g,j.marker)){return""}break;case"ifnotset":if(e(g,j.marker)){return""}break;case"suffix":switch(g){case"br":k="<br/>";break;case"comma":k=",";break;case"comma_space":k=", ";break;case"space":k=" ";break;default:break}break;case"wrap":switch(g){case"directions":f='<a href="https://'+slplus.options.map_domain+"/maps?saddr="+encodeURIComponent(cslmap.getSearchAddress(cslmap.address))+"&daddr="+encodeURIComponent(j.marker.fullAddress)+'" target="_blank" class="storelocatorlink">';k="</a> ";break;case"img":f='<img src="';k='" class="sl_info_bubble_main_image">';break;case"mailto":f='<a href="mailto:';k='" target="_blank" class="storelocatorlink">';break;case"website":f='<a href="';k='" target="'+((slplus.options.use_same_window!=="0")?"_self":"_blank")+'" id="slp_marker_website" class="storelocatorlink" >';break;case"fullspan":f='<span class="results_line location_'+d+'">';k="</span>";break;default:break}break;case"format":switch(g){case"decimal1":i=parseFloat(i).toFixed(1);break;case"decimal2":i=parseFloat(i).toFixed(2);break;case"sanitize":i=i.replace(/\W/g,"_");break;case"text":i=jQuery("<div/>").html(i).text();break;default:break}break;case"raw":b=true;break;default:break}}var c=(b)?i:jQuery("<div/>").html(i).text();return f+c+k}},setup_map:function(){cslmap=new slp_Map();slp_Filter("slp_map_ready").publish(cslmap);if(!slplus.options.use_sensor){cslmap.usingSensor=false;if(slplus.options.id_addr!=null){cslmap.address=slplus.options.id_addr}if((!cslmap.address)&&(slplus.options.map_center)){cslmap.address=slplus.options.map_center}if(slplus.options.map_center_lat&&slplus.options.map_center_lng){if(typeof cslmap.build_map==="function"){var a=new google.maps.LatLng(slplus.options.map_center_lat,slplus.options.map_center_lng);cslmap.build_map(a)}}else{cslmap.doGeocode()}}},shortcode_output:function(g,e,f,a,d,c,h){var b;b=f.shortcode_modifier({modifier:a,modarg:d,field_name:e,marker:g});if(c){b=b.shortcode_modifier({modifier:c,modarg:h,field_name:e,marker:g})}return b},start_map:function(){if(jQuery("#map").length){if(typeof slplus!=="undefined"){if(typeof google!=="undefined"){slp.setup_helpers();slp.setup_map();slp.subscriptions.initalize();slplus.notifications=new slp.notification()}else{jQuery("#map").html("Looks like you turned off Store Locator Plus® Maps under General Settings but need them here.")}}else{jQuery("#map").html("Store Locator Plus® did not initialize properly.")}}},subscriptions:{},geocoder:{geocode:function(a,b){jQuery.getJSON(encodeURI(slplus.rest_url+"geocode/"+slplus.apikey+"/"+a.region+"/"+a.address)).done(function(d){if(d.error_message){var c=", with referer";if(d.error_message.includes(c)){d.error_message=d.error_message.substring(0,d.error_message.indexOf(c))}}else{d.error_message=""}b(d.results,d.status,d.error_message)}).fail(function(c){b(c,google.maps.GeocoderStatus.ERROR)})}},option:{get_from_server:function(a,b){if(typeof slplus.shortcode_attributes[a]!=="undefined"){b({value:slplus.shortcode_attributes[a]});return}jQuery.getJSON(encodeURI(slplus.rest_url+"options/filtered/"+a)).done(function(c){if(c.error_message){console.log(c.error_message)}else{c.error_message=""}b(c)}).fail(function(c){console.log("get_from_server failed")})}}};slp.subscriptions=(function(){var a="loading_locations";this.initialize=function(){slp_Filter("load_marker_action").subscribe(show_locations_processing);slp_Filter("location_search_responded").subscribe(remove_locations_processing)};this.show_locations_processing=function(){slp.important_object.slp_div.addClass(a)};this.remove_locations_processing=function(){slp.important_object.slp_div.removeClass(a)};return{initalize:initialize}})();function gm_authFailure(){var a=slplus.notifications.inline(slplus.messages.slp_system_message,slplus.messages.no_api_key);jQuery("#map").prepend(a)}slp_Marker=function(c,e,a,b,d){this.__map=c;this.__title=e;this.__position=a;this.__gmarker=null;this.__markerImage=b;this.__location_id=d;this.__init=function(){slp_Filter("marker").publish(this);this.__gmarker=new google.maps.Marker({position:this.__position,map:this.__map.gmap,title:this.__title,icon:this.protocol_tweaker(this.__markerImage)})};this.protocol_tweaker=function(f){slp.generic_object.a.href=f;if(slp.generic_object.a.hostname!==window.location.hostname){return f}slp.generic_object.a.protocol=window.location.protocol;return slp.generic_object.a.href};this.__init()};slp_Map=function(){var a=this;this.auto_bound=true;this.infowindow=new google.maps.InfoWindow();this.geocoder=slp.geocoder;this.geocoder_request=new Object();this.gmap=null;this.map_hidden=true;this.default_radius="40000";this.address=null;this.draggable=true;this.markers=null;this.usingSensor=false;this.mapHomeIconUrl=null;this.mapType=null;this.options=null;this.centerMarker=null;this.active_marker=null;this.marker=null;this.bounds=null;this.homePoint=null;this.lastCenter=null;this.lastRadius=null;this.latest_response=null;this.search_options=null;this.__init=function(){if(typeof slplus==="undefined"){var b=slplus.notifications.inline(slplus.messages.slp_system_message,slplus.messages.script_not_loaded);jQuery(".store_locator_plus").prepend(b);return}this.mapType=slplus.options.map_type;this.mapHomeIconUrl=slplus.options.map_home_icon;var c=this.getSearchAddress();if(typeof c==="undefined"){this.address=slplus.options.map_center}else{this.address=c}google.maps.event.addListener(this.infowindow,"domready",function(){jQuery(".slp_info_bubble").parent().addClass("slp_bubble_level_1");jQuery(".slp_info_bubble").parent().parent().addClass("slp_bubble_level_2");jQuery(".slp_info_bubble").parent().parent().parent().addClass("slp_bubble_level_3");jQuery(".slp_info_bubble").parent().parent().parent().parent().addClass("slp_bubble_level_4");jQuery(".slp_bubble_level_4").children("div:first-child").addClass("slp_bubble_elements");jQuery(".slp_bubble_level_4").children("div:last-child").addClass("slp_bubble_closer");jQuery(".slp_bubble_elements").children("div:first-child").addClass("slp_bubble_tail_behind");jQuery(".slp_bubble_elements").children("div:nth-child(2)").addClass("slp_bubble_behind");jQuery(".slp_bubble_elements").children("div:nth-child(3)").addClass("slp_bubble_tail_pieces");jQuery(".slp_bubble_tail_pieces").children("div:first-child").addClass("slp_bubble_left_tail");jQuery(".slp_bubble_left_tail").children("div:first-child").addClass("slp_bubble_left_tail_back");jQuery(".slp_bubble_tail_pieces").children("div:last-child").addClass("slp_bubble_right_tail");jQuery(".slp_bubble_right_tail").children("div:first-child").addClass("slp_bubble_right_tail_back");jQuery(".slp_bubble_elements").children("div:nth-child(4)").addClass("slp_bubble_background");jQuery(".slp_info_bubble").parent().parent().parent().parent().parent().addClass("slp_bubble_level_5");jQuery(".slp_info_bubble").parent().parent().parent().parent().parent().parent().addClass("slp_bubble_level_6")})};if((typeof(slplus.options.hide_map)==="undefined")||(slplus.options.hide_map!=="1")){this.build_map=function(c,d){if(!d){d=document.getElementById("map")}if(this.gmap!==null){return}this.options={center:c,mapTypeId:this.mapType,minZoom:1,zoom:parseInt(slplus.options.zoom_level)};if(slplus.options.google_map_style){jQuery.extend(this.options,{styles:JSON.parse(slplus.options.google_map_style)})}slp_Filter("map_options").publish(this.options);this.gmap=new google.maps.Map(d,this.options);google.maps.event.addListener(this.gmap,"bounds_changed",function(){a.__waitForTileLoad.call(a)});if(this.show_home_marker()){this.homePoint=c;this.addMarkerAtCenter()}if(slplus.options.immediately_show_locations!=="0"){var b=null;slplus.options.initial_radius=slplus.options.initial_radius.replace(/\D/g,"");if(/^[0-9]+$/.test(slplus.options.initial_radius)){b=slplus.options.initial_radius}this.search_options=null;this.load_markers(c,b)}slp_Filter("map_built").publish()}}this.set_active_marker_to_location=function(b){jQuery.each(this.markers,function(d,c){if(c.__location_id==b){cslmap.active_marker=c;return false}})};this.show_home_marker=function(){return(this.usingSensor||((slplus.options.immediately_show_locations!=="0")&&(slplus.options.no_homeicon_at_start!=="1")))};this.__waitForTileLoad=function(){if(this.__tilesLoaded===null){this.__tilesLoaded=google.maps.event.addListener(this.gmap,"tilesloaded",function(){a.__tilesAreLoaded.call(a)})}};this.__tilesAreLoaded=function(){jQuery("#map").find("img").css({"max-width":"none"});google.maps.event.removeListener(this.__tilesLoaded);this.__tilesLoaded=null};this.addMarkerAtCenter=function(){if(this.centerMarker){this.centerMarker.__gmarker.setMap(null)}if(this.homePoint){this.centerMarker=new slp_Marker(this,"",this.homePoint,this.mapHomeIconUrl,0)}};this.clearMarkers=function(){if(this.markers){for(markerNumber in this.markers){if(typeof this.markers[markerNumber]!=="undefined"){if(typeof this.markers[markerNumber].__gmarker!=="undefined"){this.markers[markerNumber].__gmarker.setMap(null)}}}this.markers.length=0;if(!this.saneValue("addressInput","")){this.centerMarker=null;this.homePoint=null}}};this.putMarkers=function(e){var h,i,b;this.markers=[];b=document.getElementById("map_sidebar");b.innerHTML="";i=(e)?e.length:0;if(i===0){if(this.homePoint&&this.auto_bound){this.gmap.panTo(this.homePoint)}slp.option.get_from_server("message_no_results",function(l){if(l.value){document.getElementById("map_sidebar").innerHTML='<div class="no_results_found"><h2>'+l.value+"</h2></div>"}else{console.log("No results found.  No message set.")}})}else{var f={content:"",insert_rows_at:"#map_sidebar"};slp_Filter("location_results_header").publish(f);if(f.content.trim()){slp.important_object.results.append(f.content)}var c=new google.maps.LatLngBounds();if(this.homePoint){c.extend(this.homePoint)}for(var g=0;g<i;++g){if(e[g]==null){slp.log("SLP marker number "+g+" is null. ");continue}if(typeof(e[g].data)!=="undefined"){h=e[g].data}else{h=e[g]}if(!e[g].position){e[g].position=new google.maps.LatLng(e[g].lat,e[g].lng)}c.extend(e[g].position);this.markers.push(new slp_Marker(this,h.sl_store,e[g].position,a.is_valid_icon(e[g].icon)?e[g].icon:slplus.options.map_end_icon,h.sl_id));google.maps.event.addListener(this.markers[g].__gmarker,"click",(function(m,l){return function(){a.show_map_bubble.call(a,m,l)}})(e[g],this.markers[g]));if(b){jQuery(f.insert_rows_at).append(this.createSidebar(e[g]));jQuery(f.insert_rows_at+" span:empty").hide();jQuery("#slp_results_wrapper_"+e[g].id).on("click",null,{info:e[g],marker:this.markers[g]},a.handle_location_result_click)}}if(this.gmap){this.bounds=c;if(this.auto_bound){this.gmap.fitBounds(this.bounds);if(slplus.options.no_autozoom==="1"){this.gmap.setZoom(parseInt(slplus.options.zoom_level))}else{var k=this.gmap.getZoom();var j=parseInt(slplus.options.zoom_tweak);var d=k-j;if(i<2){d=Math.min(d,15)}this.gmap.setZoom(d)}}}}slp.important_object.results.trigger("contentchanged")};this.handle_location_result_click=function(b){jQuery(this).trigger("result_clicked",b);a.show_map_bubble(b.data.info,b.data.marker)};this.is_valid_icon=function(b){return(b!==null)&&(typeof b!=="undefined")&&(b.length>4)};this.show_map_bubble=function(c,b){this.options={show_bubble:slplus.options.hide_bubble!=="1"};slp_Filter("map_options").publish(this.options);if(this.options.show_bubble){this.infowindow.setContent(this.createMarkerContent(c));this.infowindow.open(this.gmap,b.__gmarker)}};this.process_geocode_response=function(c,b,d){if((b===google.maps.GeocoderStatus.OK)&&(c.length>0)){var e={all:c,request:a.geocoder_request,best:c[0]};slp_Filter("geocode_results").publish(e);if(typeof e.best.geometry.location!==google.maps.LatLng){e.best.geometry.location=new google.maps.LatLng(e.best.geometry.location.lat,e.best.geometry.location.lng)}if(a.gmap===null){if(typeof a.build_map==="function"){a.build_map(e.best.geometry.location)}}else{a.homePoint=e.best.geometry.location;a.addMarkerAtCenter();a.load_markers(e.best.geometry.location,a.saneValue("radiusSelect","40000"))}}else{if(a.gmap===null){if(typeof a.build_map==="function"){slp.log("Map set to fallback lat/lng: "+slplus.options.map_center_lat+" , "+slplus.options.map_center_lng);a.homePoint=new google.maps.LatLng(slplus.options.map_center_lat,slplus.options.map_center_lng);a.build_map(a.homePoint);a.addMarkerAtCenter()}}else{slp.option.get_from_server("message_bad_address",function(f){if(f.value){document.getElementById("map_sidebar").innerHTML=f.value+'<br/><p class="geocode_message">Google Maps API error: <br/>'+d+'<br/>Tired of fighting the Google Maps API?  Try <a href="https://storelocatorplus.com/">our SaaS offering</a>.';"</p>"}else{console.log("Bad address.  No message set.")}});a.clearMarkers()}}};this.doGeocode=function(){var b;a.geocoder_request.address=a.address;a.geocoder_request.region=((typeof slplus.options.map_region!=="undefined")&&(slplus.options.map_region))?slplus.options.map_region:"us";if(slplus.options.searchnear==="currentmap"){if(a.gmap){a.geocoder_request.bounds=a.gmap.getBounds()}}slp_Filter("geocoder_request").publish(a.geocoder_request);a.geocoder.geocode(a.geocoder_request,a.process_geocode_response)};this.__createAddress=function(c){var b="";if(c.address!==""){b+=c.address}if(c.address2!==""){b+=", "+c.address2}if(c.city!==""){b+=", "+c.city}if(c.state!==""){b+=", "+c.state}if(c.zip!==""){b+=", "+c.zip}if(c.country!==""){b+=", "+c.country}return b};this.createMarkerContent=function(b){b.fullAddress=this.__createAddress(b);return slplus.options.bubblelayout.replace_shortcodes(b)};this.get_search_options=function(){if(this.search_options===null){this.search_options=JSON.parse(JSON.stringify(slplus.options));delete this.search_options.bubblelayout;delete this.search_options.results_header;delete this.search_options.results_header_1;delete this.search_options.results_header_2;delete this.search_options.results_header_3;delete this.search_options.results_header_4;delete this.search_options.resultslayout;delete this.search_options.searchlayout;delete this.search_options.locations;delete this.search_options.layout}return this.search_options};this.getSearchAddress=function(c){var b=jQuery("#addressInput").val();if(!b){if((typeof cslmap!=="undefined")&&cslmap.usingSensor&&(slp.sensor.lat!==0)&&(slp.sensor.lng!==0)){b=slp.sensor.lat+","+slp.sensor.lng}else{b=c}}return b};this.saneValue=function(d,b){var c=document.getElementById(d);if(c===null){c=b.trim()}else{c=c.value.trim()}return c};this.load_markers=function(c,b){var e,f,d;if(c===null){c=this.gmap.getCenter()}this.lastCenter=c;this.lastRadius=b;e={action:"csl_ajax_search",address:this.saneValue("addressInput","no address entered"),formdata:jQuery("#searchForm").serialize(),lat:c.lat(),lng:c.lng(),options:this.get_search_options(),radius:b};f=this.saneValue("nameSearch","");if(f!==""){e.store_name=f}d=this.saneValue("tag_to_search_for","");if(d!==""){e.tags=d}slp_Filter("load_marker_action").publish(e);if(slplus.options.immediately_show_locations!=="0"){e.action="csl_ajax_onload";slplus.options.immediately_show_locations="0";this.search_options=null}slp.send_ajax(e,a.process_ajax_response)};this.process_ajax_response=function(b){valid_response=(typeof b.response!=="undefined");if(valid_response){valid_response=b.success}slp_Filter("location_search_responded").publish(b);if(valid_response){cslmap.latest_response=b;cslmap.clearMarkers();slp_Filter("locations_found").publish(b);cslmap.putMarkers(b.response);jQuery("#map").trigger("markers_dropped")}else{if(window.console){slp.log("SLP server did not send back a valid JSONP response.");if(typeof b!=="undefined"){slp.log("Response: "+b)}if(typeof b.message!=="undefined"){var c=document.getElementById("map_sidebar");c.innerHTML=b.message}}}slp_Filter("location_search_processed").publish()};this.searchLocations=function(){var c=((typeof slplus.options.append_to_search!=="undefined")&&slplus.options.append_to_search)?" "+slplus.options.append_to_search.trim():"";var b=this.saneValue("addressInput","")+c;this.unhide_map();google.maps.event.trigger(this.gmap,"resize");if(b){this.address=b;this.doGeocode()}else{this.load_markers(null,this.saneValue("radiusSelect","40000"))}};this.createSidebar=function(e){e.pro_tags="";if(jQuery.trim(e.tags)!==""){var d=e.tags.replace(/\W/g,"_");e.pro_tags='<br/><div class="'+d+' slp_result_table_tags"><span class="tagtext">'+e.tags+"</span></div>"}e.phone_with_label=(jQuery.trim(e.phone)!=="")?slplus.options.label_phone+e.phone:"";e.fax_with_label=(jQuery.trim(e.fax)!=="")?slplus.options.label_fax+e.fax:"";var b=this.__createAddress(e);e.location_address=encodeURIComponent(b);e.search_address=encodeURIComponent(this.getSearchAddress(this.address));e.hours_sanitized=jQuery("<div/>").html(e.hours).text();var c={content:slplus.options.resultslayout.replace_shortcodes(e),finished:false};slp_Filter("wrap_location_results").publish(c);if(!c.finished){c.content='<div class="results_wrapper" id="slp_results_wrapper_'+e.id+'">'+c.content+"</div>"}return c.content};this.unhide_map=function(){if(this.map_hidden){jQuery("#map_box_image").hide();jQuery("#map_box_map").show();this.map_hidden=false}};this.__init()};